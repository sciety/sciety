# 1c. Guidance for deployment by research communities

Below is a guide for research communities, this could be exposed as a page on Sciety or via the Sciety blog

---

A guide for researchers and research communities to deploy their own [Open Science Network instance powered by Bonfire](https://openscience.network/) on NixOS.

## What You'll Build

By following this guide, you'll deploy a federated discussion platform specifically designed for open science communities. Your instance will:

- Enable researchers to discuss research in a trusted, community-controlled space
- Connect to the broader fediverse using ActivityPub for decentralised communication
- Integrate with ORCID for researcher identity verification
- Optionally integrate with Zenodo for archiving important discussions
- Run on reproducible infrastructure that can be easily replicated

## Who This Guide Is For

This guide is written for:

- **Researchers** enthusiastic about open science who want to try out new ways to engage with their communities
- **University IT teams** looking to deploy federated platforms for their research communities
- **Grassroots collectives and preprint advocates** who want independent infrastructure

This is a technical guide, but should be enough for anyone who:
- Is comfortable using a terminal/command line application
- Has an understanding of web hosting concepts (domains, DNS, SSH)
- Has an understanding of open researcher technologies eg ORCID, Zenodo, OpenAlex

## Why NixOS?

NixOS ensures your deployment is **reproducible** and **reliable**. Unlike traditional server setups where ad-hoc changes accumulate over time (leading to "configuration drift"), NixOS lets you describe your entire system in a single configuration file. This means:

- **Consistency**: Every deployment produces exactly the same result
- **Version control**: Track changes to your infrastructure like code
- **Easy replication**: Share your configuration with other communities
- **Rollback capability**: Easily revert if something goes wrong

For more background on NixOS, see the [platform descriptions](./platform-descriptions.md).

Our project is specifically focussed on documenting a NixOS approach, though there are [many documented options for  Bonfire deployment](https://docs.bonfirenetworks.org/deploy.html)

---

## Prerequisites

Before starting, ensure you have:

1. **A domain name** (e.g., `opensciencenetwork.yourinstitution.org`)
   - You'll need to configure DNS A/AAAA records pointing to your server

2. **A computer running Linux or macOS  (Windows is not tested here, but should be similar) ** to perform the deployment
   - NixOS will be installed on your cloud server, but you deploy from your local machine

3. **An email sending service** for account verification and notifications
   - Options include: SendGrid, Mailgun, Mailjet, or SMTP (we've tested with Sendgrid and Gmail)
   - You'll need API credentials or SMTP details

4. **ORCID application credentials** (required for Open Science flavour)
   - Register at [ORCID Developer Tools](https://orcid.org/developer-tools)
   - Or use [ORCID Sandbox](https://sandbox.orcid.org/developer-tools) for testing

5. **Zenodo application credentials** (optional, for archiving discussions)
   - Register at [Zenodo Developers](https://zenodo.org/account/settings/applications/)
   - Or use [Zenodo Sandbox](https://sandbox.zenodo.org/account/settings/applications/) for testing

6. **SSH key pair** for server access
   - Generate with: `ssh-keygen -t ed25519 -C "your@email.org"`

---

## Hardware Requirements

Based on testing, we recommend the following specifications:

- **CPU**: 2 cores minimum (shared vCPU acceptable for small communities)
- **RAM**: 4GB minimum
- **Storage**: 40GB minimum 
- **Network**: IPv4 address (IPv6 optional)

These specifications align with the **CX22** instance type on Hetzner Cloud, which costs approximately €5-7/month at the time of writing and has been successful in our testing.

---

## Deployment Methods

This guide covers deployment to **Hetzner Cloud** using the `[nixos-anywhere](https://github.com/nix-community/nixos-anywhere)` tool for automated setup. This method has been tested and documented by the Sciety/Bonfire collaboration.

### Alternative Cloud Providers

The NixOS deployment approach described here can be adapted for other cloud providers. Placeholders for future documentation:

#### Digital Ocean
*Documentation coming soon. The general approach will work but requires provider-specific networking and initial OS setup adjustments.*

#### Amazon Web Services (AWS) with Kubernetes

For deploying to AWS or any Kubernetes cluster, Sciety maintains a Helm chart for simplified deployment.

https://github.com/sciety/bonfire-helm-chart


#### Other NixOS-Friendly Hosts
See the [NixOS-friendly hosters wiki](https://wiki.nixos.org/wiki/NixOS_friendly_hosters) for other compatible providers.

---

## Part 1: Registering External Services

### 1.1 Register Your ORCID Application

ORCID integration allows researchers to verify their identity and connect their contributions to their scholarly profile.

1. **Visit ORCID Developer Tools**
   - Production: https://orcid.org/developer-tools
   - Testing/Sandbox: https://sandbox.orcid.org/developer-tools

2. **Register a new application**
   - **Application name**: `[Your Community Name] Discussions` (e.g., "Biology Preprints Discussions")
   - **Application description**: Brief description of your community discussion platform
   - **Application website**: Your domain (e.g., `https://opensciencenetwork.yourinstitution.org`)

3. **Configure redirect URIs**
   Add the following callback URL (replace `yourdomain.org` with your actual domain):
   ```
   https://yourdomain.org/settings/orcid/callback
   ```

4. **Save your credentials**
   After registration, you'll receive:
   - **Client ID** (e.g., `APP-ABC123XYZ`)
   - **Client Secret** (keep this secure!)

   You'll also need to note:
   - **Environment**: `production` or `sandbox`
   - **Member API**: Whether your organisation has ORCID member API access (most won't)

### 1.2 Register Your Zenodo Application (Optional)

Zenodo integration enables archiving of important discussions for long-term preservation.

1. **Visit Zenodo Developers**
   - Production: https://zenodo.org/account/settings/applications/
   - Testing/Sandbox: https://sandbox.zenodo.org/account/settings/applications/

2. **Create a new application**
   - **Name**: `[Your Community Name] Discussions`
   - **Description**: Brief description of archiving purpose
   - **Website**: Your domain
   - **Redirect URI**:
     ```
     https://yourdomain.org/settings/zenodo/callback
     ```

3. **Save your credentials**
   - **Client ID**
   - **Client Secret** (keep this secure!)
   - **Environment**: `production` or `sandbox`

---

## Part 2: Setting Up Your Server

### 2.1 Create a Hetzner Cloud Server

1. **Create a Hetzner Cloud account** at https://www.hetzner.com/cloud

2. **Add your SSH public key**
   - Navigate to Security → SSH Keys
   - Click "Add SSH Key"
   - Paste your public key (from `~/.ssh/id_ed25519.pub`), if this does not exist you can generate keys with `ssh-keygen -t ed25519 -C "your@email.org"`
   - Give it a descriptive name (e.g., "Mark's Laptop")

3. **Create a new server**
   - Click "Add Server"
   - **Location**: Choose based on your location/data residency requirements
   - **Image**: Select **Ubuntu** (we'll replace it with NixOS)
   - **Type**: Choose **CX22** (or larger for bigger communities)
     - 2 vCPU
     - 4 GB RAM
     - 40 GB SSD
   - **Networking**:
     - IPv4: ✓ (required)
     - IPv6: ✓ (optional)
   - **SSH Keys**: Select the key you added
   - **Name**: Give it a meaningful name (e.g., "bonfire-discussions")

4. **Note the server IP address** from the Hetzner dashboard
   You'll need this for deployment and DNS configuration.

### 2.2 Configure DNS

Before deploying, configure your domain's DNS:

1. **Create an A record** pointing to your server's IPv4 address:
   ```
   opensciencenetwork.yourinstitution.org.  IN  A  <server-ipv4-address>
   ```

2. **Create an AAAA record** if using IPv6:
   ```
   opensciencenetwork.yourinstitution.org.  IN  AAAA  <server-ipv6-address>
   ```

3. **Wait for propagation** (can take up to 48 hours, usually much faster)
   Test with: `dig opensciencenetwork.yourinstitution.org`

---

## Part 3: Preparing Your Local Environment

### 3.1 Install Nix (if not already installed)

On your local machine, install Nix:

```bash
sh <(curl -L https://nixos.org/nix/install) --daemon
```

After installation, close and reopen your terminal.

### 3.2 Clone the Deployment Repository

We'll use the Sciety Bonfire NixOS configuration as a starting point:

```bash
# Navigate to your projects directory
cd ~/projects  # or wherever you keep code

# Clone the repository
git clone https://github.com/sciety/sciety-bonfire-nix.git
cd sciety-bonfire-nix
```

This repository contains:
- **flake.nix**: Defines the NixOS system and its dependencies
- **configuration.nix**: Main system configuration
- **hardware-configuration.nix**: Hardware detection template
- **secrets/** directory structure for encrypted secrets

---

## Part 4: Configuring Secrets

NixOS can manage secrets securely using `sops-nix`, based on [sops](https://github.com/getsops/sops) which encrypts sensitive data that only your server can decrypt.

### 4.1 Generate Age Keys

Age is a modern encryption tool used by sops-nix.

**On your server** (SSH into it first using the IP from Hetzner):

```bash
ssh root@<your-server-ip>

# Generate age keys for the server
mkdir -p ~/.config/sops/age
nix-shell -p age --run 'age-keygen -o /root/.config/sops/age/keys.txt'
```

This will output a public key like:
```
Public key: age1abc123...xyz789
```

**Save this public key** - you'll need it for the next step.

**On your local machine** (for managing secrets):

```bash
mkdir -p ~/.config/sops/age
nix-shell -p age --run 'age-keygen -o ~/.config/sops/age/keys.txt'
```

Save this public key as well.

### 4.2 Create SOPS Configuration

In your cloned repository, create or edit `.sops.yaml`:

```yaml
keys:
    # Your laptop/PC public key (for editing secrets)
    - &user_yourself age1xxx...your-local-public-key...xxx
    # Your server's public key (for decrypting secrets)
    - &host_yourserver age1xxx...your-server-public-key...xxx

creation_rules:
    - path_regex: secrets/production\.yaml$
      key_groups:
          - age:
                - *user_yourself
                - *host_yourserver
```

### 4.3 Generate Random Secrets

Generate secure random values for your secrets:

```bash
# Generate several random secrets at once
for secret in SECRET_KEY_BASE SIGNING_SALT ENCRYPTION_SALT POSTGRES_PASSWORD MEILI_MASTER_KEY; do
  echo "$secret:"
  nix-shell -p openssl --run 'openssl rand -base64 32'
  echo ""
done
```

Save these values temporarily - you'll add them to the encrypted file next.

### 4.4 Create Encrypted Secrets File

Create a directory for secrets if it doesn't exist:

```bash
mkdir -p secrets
```

Create and edit your encrypted secrets file:

```bash
nix-shell -p sops --run 'sops secrets/production.yaml'
```

Your default editor will open. Add your secrets in this format:

```yaml
bonfire:
    secret_key_base: <generated-value-1>
    signing_salt: <generated-value-2>
    encryption_salt: <generated-value-3>
    postgres_password: <generated-value-4>
    meili_master_key: <generated-value-5>
    mail_key: <your-sendgrid-or-mailgun-api-key>
    orcid_client_secret: <your-orcid-client-secret>
    zenodo_client_secret: <your-zenodo-client-secret>  # optional
```

**Important notes:**
- `mail_key`: Your email service API key (SendGrid, Mailgun, etc.) or SMTP password
- `orcid_client_secret`: The secret from your ORCID application registration
- `zenodo_client_secret`: The secret from your Zenodo application (if using)

Save and close the editor. The file will be automatically encrypted.

You can verify encryption by viewing the file:

```bash
cat secrets/production.yaml
```

You should see encrypted content, not plain text.

### 4.5 Configure Secrets in configuration.nix

Ensure your `configuration.nix` includes the sops configuration. This should already be present in the sciety-bonfire-nix repository, but verify it looks like this:

```nix
# Secrets management
sops.defaultSopsFile = ./secrets/production.yaml;
sops.age.sshKeyPaths = [ "/etc/ssh/ssh_host_ed25519_key" ];
sops.age.keyFile = "/root/.config/sops/age/keys.txt";
sops.age.generateKey = false;

# Define which secrets to load
sops.secrets."bonfire/secret_key_base" = {};
sops.secrets."bonfire/signing_salt" = {};
sops.secrets."bonfire/encryption_salt" = {};
sops.secrets."bonfire/postgres_password" = {
  mode = "0440";
  group = config.users.users.postgres.group;
};
sops.secrets."bonfire/mail_key" = {};
sops.secrets."bonfire/meili_master_key" = {};
sops.secrets."bonfire/orcid_client_secret" = {};
sops.secrets."bonfire/zenodo_client_secret" = {};  # optional
```

---

## Part 5: Configuring Bonfire for Open Science

### 5.1 Edit configuration.nix

Open `configuration.nix` in your repository and configure the Bonfire module:

```nix
bonfire = {
  # Use the open_science flavour
  flavor = "open_science";

  # Bonfire version (check https://hub.docker.com/r/bonfirenetworks/bonfire/tags for latest)
  version = "1.0.0-rc.3";

  # Your domain name
  hostname = "opensciencenetwork.yourinstitution.org";

  # Email configuration
  mail-from = "bonfire@yourinstitution.org";
  mail-backend = "sendgrid";  # or "mailgun", "mailjet", "smtp"
  mail-key = "/run/secrets/bonfire/mail_key";

  # Search configuration
  meili-master-key = "/run/secrets/bonfire/meili_master_key";
  meilisearch-tag = "v1.14";
};
```

**Important**: Set `flavor = "open_science"` - this enables the Open Science Network features including ORCID and Zenodo integration.

### 5.2 Add ORCID and Zenodo Configuration

Since the bonfire module doesn't have built-in options for ORCID/Zenodo environment variables, we need to extend the container environment. Add this to your `configuration.nix`:

```nix
# Extend the Bonfire container environment with ORCID/Zenodo settings
virtualisation.oci-containers.containers.bonfire.environment = lib.mkForce (
  config.virtualisation.oci-containers.containers.bonfire.environment // {
    # ORCID Configuration (Required for open_science flavour)
    ORCID_CLIENT_ID = "APP-YOUR-ORCID-CLIENT-ID";
    # Uncomment if using sandbox:
    # ORCID_ENV = "sandbox";
    # Uncomment if your organization is an ORCID member:
    # ORCID_WITH_MEMBER_API = "yes";

    # Zenodo Configuration (Optional)
    # ZENODO_CLIENT_ID = "your-zenodo-client-id";
    # Uncomment if using sandbox:
    # ZENODO_ENV = "sandbox";
  }
);

# Mount the ORCID and Zenodo secrets into the container
virtualisation.oci-containers.containers.bonfire.volumes =
  config.virtualisation.oci-containers.containers.bonfire.volumes ++ [
    "/run/secrets/bonfire/orcid_client_secret:/run/secrets/bonfire/orcid_client_secret:ro"
    # Optional: Uncomment if using Zenodo
    # "/run/secrets/bonfire/zenodo_client_secret:/run/secrets/bonfire/zenodo_client_secret:ro"
  ];

# Add ORCID/Zenodo secrets to the container startup command
virtualisation.oci-containers.containers.bonfire.cmd = lib.mkForce [
  "-c"
  ''
    export MAIL_KEY="$(cat /run/secrets/bonfire/mail_key)"; \
    export MEILI_MASTER_KEY="$(cat /run/secrets/bonfire/meili_master_key)"; \
    export POSTGRES_PASSWORD="$(cat /run/secrets/bonfire/postgres_password)"; \
    export SECRET_KEY_BASE="$(cat /run/secrets/bonfire/secret_key_base)"; \
    export SIGNING_SALT="$(cat /run/secrets/bonfire/signing_salt)"; \
    export ENCRYPTION_SALT="$(cat /run/secrets/bonfire/encryption_salt)"; \
    export ORCID_CLIENT_SECRET="$(cat /run/secrets/bonfire/orcid_client_secret)"; \
    export ZENODO_CLIENT_SECRET="$(cat /run/secrets/bonfire/zenodo_client_secret)"; \
    exec -a ./bin/bonfire ./bin/bonfire start
  ''
];
```

**Replace `APP-YOUR-ORCID-CLIENT-ID`** with your actual ORCID Client ID from Part 1.1.

### 5.3 Configure NGINX Reverse Proxy

Ensure your `configuration.nix` includes NGINX configuration with SSL:

```nix
# SSL/TLS Certificate Management
security.acme.acceptTerms = true;
security.acme.defaults.email = "admin@yourinstitution.org";

# NGINX Reverse Proxy
services.nginx = {
  enable = true;
  virtualHosts = {
    "opensciencenetwork.yourinstitution.org" = {
      forceSSL = true;
      enableACME = true;
      locations."/" = {
        proxyPass = "http://127.0.0.1:4000";
        extraConfig = ''
          proxy_redirect          off;
          proxy_set_header        Host $host;
          proxy_set_header        X-Real-IP $remote_addr;
          proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_http_version      1.1;
          proxy_cache_bypass      $http_upgrade;
          proxy_set_header        Upgrade $http_upgrade;
          proxy_set_header        Connection "upgrade";
          proxy_set_header        X-Forwarded-Proto $scheme;
          proxy_set_header        X-Forwarded-Host  $host;
        '';
      };
    };
  };
};

# Firewall Configuration
networking = {
  hostName = "bonfire-discussions";
  firewall = {
    enable = true;
    allowedTCPPorts = [ 22 80 443 ];
    allowedUDPPorts = [];
  };
};
```

### 5.4 Update Your SSH Keys

Replace the example SSH keys in `configuration.nix` with your own:

```nix
users.users.root.openssh.authorizedKeys.keys = [
  "ssh-ed25519 AAAA... your-email@example.org"
];
```

You can get your public key with:
```bash
cat ~/.ssh/id_ed25519.pub
```

---

## Part 6: Deploying to Your Server

### 6.1 Reset Hardware Configuration

The repository includes a generic hardware configuration template. Reset it:

```bash
curl https://raw.githubusercontent.com/nix-community/nixos-anywhere-examples/refs/heads/main/hardware-configuration.nix > hardware-configuration.nix
```

### 6.2 Update flake.nix

Ensure your `flake.nix` references the bonfire-nix module. It should look like this:

```nix
{
  description = "NixOS configuration for Open Science Network / Bonfire";

  inputs = {
    nixpkgs.url = "github:NixOS/nixpkgs/nixos-25.05";
    bonfire-nix.url = "github:bonfire-networks/bonfire-nix/main";
    flake-utils.url = "github:numtide/flake-utils";
    sops-nix.url = "github:Mic92/sops-nix";
    sops-nix.inputs.nixpkgs.follows = "nixpkgs";
  };

  outputs = { self, nixpkgs, bonfire-nix, flake-utils, sops-nix, ... }@inputs: {
    nixosConfigurations.nixos-vm = nixpkgs.lib.nixosSystem {
      system = "x86_64-linux";
      modules = [
        ./configuration.nix
        ./hardware-configuration.nix
        sops-nix.nixosModules.sops
        bonfire-nix.nixosModules.bonfire
      ];
    };
  };
}
```

### 6.3 Deploy with nixos-anywhere

Now deploy your configuration to the server:

```bash
nix run github:nix-community/nixos-anywhere -- \
  --flake .#nixos-vm \
  --generate-hardware-config nixos-generate-config ./hardware-configuration.nix \
  --target-host root@<your-server-ip>
```

**Replace `<your-server-ip>`** with your Hetzner server's IP address.

This command will:
1. Connect to your Ubuntu server via SSH
2. Partition the disk according to the disko configuration
3. Install NixOS
4. Copy your configuration
5. Build and activate the system
6. Install all services (PostgreSQL, Meilisearch, Bonfire)
7. Configure NGINX with automatic SSL certificates

The process can take **10-20 minutes** depending on your connection speed.

### 6.4 Monitor the Deployment

The deployment process will show progress output. Key stages:

1. **Connecting to server**: SSH connection established
2. **Partitioning disks**: Creating filesystem
3. **Installing NixOS**: Base system installation
4. **Building configuration**: Compiling your system
5. **Activating services**: Starting Bonfire, PostgreSQL, etc.

If you see errors, check:
- SSH key is correctly configured on Hetzner
- Server IP address is correct
- Your local machine can reach the server

---

## Part 7: Post-Deployment Setup

### 7.1 Verify Services Are Running

SSH into your new NixOS server:

```bash
ssh root@<your-server-ip>
```

Check that services are running:

```bash
# Check Bonfire container
docker ps

# Check PostgreSQL
systemctl status postgresql

# Check NGINX
systemctl status nginx

# Check Bonfire logs
docker logs docker-bonfire
```

### 7.2 Access Your Instance

Visit your domain in a web browser:

```
https://opensciencenetwork.yourinstitution.org
```

You should see the Bonfire welcome page!

### 7.3 Create Your First Admin Account

The **first user to sign up** becomes the instance administrator automatically.

1. Visit: `https://openswciencenetwork.yourinstitution.org/signup`
2. Fill in your details
3. Check your email for the verification link
4. Click the verification link

You now have admin access to configure your instance!

### 7.4 Configure ORCID Connection

As an admin:

1. Log into your instance
2. Navigate to **Settings** → **Add an external account**
3. Click **Sign in with ORCID**
4. Authorise the connection
5. Your ORCID profile will be linked to your Bonfire account

### 7.5 Configure Zenodo (Optional)

If you configured Zenodo:

1. Navigate to **Settings** → **Add an external account**
2. Click **Sign in with Zenodo**
3. Authorise the connection
4. You can now archive important discussions to Zenodo

---

## Part 8: Managing Your Instance

### 8.1 Updating Configuration

To make changes to your instance:

1. **Edit configuration locally**:
   ```bash
   cd ~/projects/sciety-bonfire-nix
   nano configuration.nix  # or your preferred editor
   ```

2. **Update secrets if needed**:
   ```bash
   nix-shell -p sops --run 'sops secrets/production.yaml'
   ```

3. **Rebuild the system**:
   ```bash
   nixos-rebuild switch --flake .#nixos-vm --target-host root@<your-server-ip>
   ```

The system will rebuild and switch to the new configuration atomically.

### 8.2 Updating Bonfire Version

To update to a newer Bonfire release:

1. Check available versions: https://hub.docker.com/r/bonfirenetworks/bonfire/tags

2. Edit `configuration.nix`:
   ```nix
   bonfire = {
     version = "1.0.0-rc.4";  # new version
     # ... rest of config
   };
   ```

3. Rebuild:
   ```bash
   nixos-rebuild switch --flake .#nixos-vm --target-host root@<your-server-ip>
   ```

### 8.3 Viewing Logs

```bash
# Bonfire application logs
docker logs docker-bonfire

# NGINX logs
journalctl -u nginx -f

# PostgreSQL logs
journalctl -u postgresql -f

# All system logs
journalctl -f
```

### 8.4 Database Backups

Set up regular PostgreSQL backups:

```bash
# Manual backup
pg_dump -U bonfire bonfire > backup-$(date +%Y%m%d).sql

# Automated backups (add to configuration.nix)
services.postgresqlBackup = {
  enable = true;
  databases = [ "bonfire" ];
  startAt = "*-*-* 02:00:00";  # Daily at 2 AM
};
```

### 8.5 Rolling Back Changes

If an update causes issues, NixOS makes it easy to rollback:

```bash
# On the server
nixos-rebuild switch --rollback

# Or select from boot menu during restart
```

---

## Troubleshooting

### Services Won't Start

**Check Docker container status:**
```bash
docker ps -a
docker logs docker-bonfire
```

**Common issues:**
- Database connection failed: Check PostgreSQL is running (`systemctl status postgresql`)
- Port already in use: Check nothing else is using port 4000
- Secrets not loading: Verify sops configuration and age keys

### SSL Certificate Issues

**ACME (Let's Encrypt) failures:**
```bash
# Check NGINX logs
journalctl -u nginx -f

# Verify DNS is correct
dig opensciencenetwork.yourinstitution.org

# Manually trigger certificate renewal
systemctl restart nginx
```

**Common issues:**
- DNS not propagated: Wait up to 48 hours
- Port 80/443 not accessible: Check firewall settings
- Domain doesn't point to server: Verify DNS A/AAAA records

### ORCID Connection Not Working

**Verify environment variables:**
```bash
docker exec docker-bonfire env | grep ORCID
```

Should show:
```
ORCID_CLIENT_ID=APP-...
ORCID_CLIENT_SECRET=...
```

**Common issues:**
- Wrong redirect URI: Must match exactly what's in ORCID app settings
- Using sandbox credentials in production: Check `ORCID_ENV` variable
- Client secret not loaded: Check sops secrets are mounted correctly

### Email Not Sending

**Check mail configuration:**
```bash
docker exec docker-bonfire env | grep MAIL
```

**Common issues:**
- Invalid API key: Verify with your email provider
- Wrong mail backend: Check `MAIL_BACKEND` matches your provider
- Firewall blocking SMTP: Ensure port 465/587 is accessible

### Getting Help

- **Bonfire Community**:
  - Matrix: https://matrix.to/#/#bonfire-networks:matrix.org
  - Fediverse: https://indieweb.social/@bonfire

- **NixOS Community**:
  - Discourse: https://discourse.nixos.org
  - Matrix: https://matrix.to/#/#nix:nixos.org


---

## Next Steps

### Customise Your Instance

1. **Set up community guidelines**
   - Create a Code of Conduct
   - Configure moderation settings
   - Define community values

2. **Configure appearance**
   - Upload your institution's logo
   - Customise colors and branding
   - Set welcome messages

3. **Invite researchers**
   - Generate invite links from Settings
   - Or enable open registration with moderation

### Connect to the Fediverse

Your instance can federate with other ActivityPub platforms:

- **Follow researchers** on Mastodon, Bonfire, and other platforms
- **Share discussions** that appear on federated timelines
- **Build networks** across institutional boundaries

---

## Additional Resources

- **Bonfire Documentation**: https://docs.bonfirenetworks.org
- **Open Science Network**: https://openscience.network
- **NixOS Manual**: https://nixos.org/manual/nixos/stable/
- **sops-nix Guide**: https://github.com/Mic92/sops-nix
- **ActivityPub Specification**: https://www.w3.org/TR/activitypub/


---

## Contributing Improvements

This deployment guide is part of the NLnet-funded "Open Science flavour of Bonfire on NixOS" project. [Improvements and feedback are welcome](https://us10.list-manage.com/contact-form?u=cdd934bce0d72af033c181267&form_id=4034dccf020ca9b50c404c32007ee091)
---

## Acknowledgments

This work is supported by NLnet Foundation as part of the "An OpenScience flavour of Bonfire on NixOS for preprints" project. The deployment approach builds on collaborative work between:

- **Sciety** - Providing infrastructure and use case validation
- **Bonfire Networks** - Developing the federated platform
- **NixOS Community** - Tools and modules for reproducible deployments

---

