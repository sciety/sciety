# 1e. Extended nixOS/Guix and Bonfire federation experiments and documentation

This report summarizes the work carried out to extend and document Bonfire deployments on both NixOS and Guix, as well as the successful federation between Bonfire instances running on either distribution and with other ActivityPub platforms such as Mastodon. These experiments demonstrate that Bonfire's Open Science and Social flavors can operate reliably across heterogeneous environments while maintaining full interoperability within the wider fediverse.


## Email System Functionality on NixOS

Tests were carried out using Proton Mail and Gmail, and email delivery worked as expected via the SendGrid.


## Cross-Instance Fediverse Communication with Social flavor

Early federation tests showed that communication across Bonfire and other ActivityPub systems worked:

- **Private messages** from Mastodon to Bonfire functioned correctly.
- **Regular posts** federated bidirectionally.
- Following **Mastodon** accounts worked without issues.

A limitation was identified: the Social flavor (dev-discussions) could not communicate with the Open Science flavor (discussions) when running different versions. This led to the next phase of ensuring that both instances operate on the same version to avoid incompatibilities.


## Deployment of Open Science Flavor on NixOS

The Open Science NixOS flavor was successfully deployed at `https://dev-discussions.sciety.org`.

Federation across Open Science instances performed well, allowing users to follow each other across deployments. Successful tests also included federation with Mastodon.


## Documentation and DigitalOcean Deployment Work

A full deployment process for Bonfire on NixOS was documented in the [Bonfire NixOS flake](https://github.com/bonfire-networks/bonfire-nix?tab=readme-ov-file#usage).

Using `nixos-anywhere`, a NixOS instance was successfully deployed onto an Ubuntu-based DigitalOcean droplet. Key findings from this deployment include:

- A minimum of 1.5 GB of RAM is required (1 GB installations crash).
- Bonfire recommends 8 GB of RAM for production.
- The setup worked with 25 GB SSD storage.
- Deploying directly with the Bonfire flake produced connectivity issues, but deploying with a generic `nixos-anywhere` example first and then reconfiguring resolved them.

Additional discussions led to adding Zenodo and ORCID integration options to the secrets configuration, including a boolean toggle to switch between sandbox and production modes.


## Guix Testing and Cross-Distro Federation

Testing on Guix demonstrated that:

- Giacomo's Guix-based Bonfire instance federated successfully with [discussions.sciety.org](https://discussions.sciety.org).
- Deployment of the Open Science flavor on Guix succeeded.
- Federation with Mastodon worked.

---

## Conclusion

The experiments confirm that Bonfire can be reliably deployed on both NixOS and Guix, and that federation works across flavors, across distributions, and with the wider fediverse. The next key steps would be to package Bonfire as a native Guix package and a native Nix package, further simplifying deployment and enabling broader adoption across both ecosystems.
